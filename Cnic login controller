import javafx.fxml.FXML;
import javafx.scene.control.Label;
import javafx.scene.control.PasswordField;
import javafx.scene.control.TextField;


public class CNICLoginController {


    @FXML
    private TextField cnicField;


    @FXML
    private PasswordField passwordField;

    @FXML
    private Label messageLabel;


    // Custom Exception class for CNIC validation
    public static class CNICException extends Exception {
        public CNICException(String message) {
            super(message);
        }
    }


    @FXML
    private void handleLogin() {
        // Clear previous message
        messageLabel.setText("");
        messageLabel.setStyle("-fx-text-fill: yellow; -fx-font-weight: bold;");


        String cnic = cnicField.getText();
        String password = passwordField.getText();

        try {
            validateCNIC(cnic);
            validatePassword(password);
            messageLabel.setText("Login successful!");
            messageLabel.setStyle("-fx-text-fill: limegreen; -fx-font-weight: bold;");
        } catch (CNICException e) {
            messageLabel.setText("CNIC Error: " + e.getMessage());
            messageLabel.setStyle("-fx-text-fill: red; -fx-font-weight: bold;");
        } catch (IllegalArgumentException e) {
            messageLabel.setText("Password Error: " + e.getMessage());
            messageLabel.setStyle("-fx-text-fill: red; -fx-font-weight: bold;");
        } catch (Exception e) {
            messageLabel.setText("Unexpected Error: " + e.getMessage());
            messageLabel.setStyle("-fx-text-fill: red; -fx-font-weight: bold;");
        }
    }


    // CNIC validation method
    private void validateCNIC(String cnic) throws CNICException {
        if (cnic == null || cnic.isEmpty()) {
            throw new CNICException("CNIC cannot be empty.");
        }
        // Pattern: 5 digits - 7 digits - 1 digit, e.g. 12345-1234567-1
        String cnicPattern = "\\d{5}-\\d{7}-\\d{1}";
        if (!cnic.matches(cnicPattern)) {
            throw new CNICException("Invalid CNIC format. Correct format: 12345-1234567-1");
        }
    }

    // Password validation method
    private void validatePassword(String password) {
        if (password == null || password.isEmpty()) {
            throw new IllegalArgumentException("Password cannot be empty.");
        }
        if (password.length() < 6) {
            throw new IllegalArgumentException("Password must be at least 6 characters long.");
        }
        // For example, check if password contains at least one digit and one letter
        if (!password.matches(".*[a-zA-Z].*")) {
            throw new IllegalArgumentException("Password must contain at least one letter.");
        }
        if (!password.matches(".*\\d.*")) {
            throw new IllegalArgumentException("Password must contain at least one digit.");
        }
    }
}

